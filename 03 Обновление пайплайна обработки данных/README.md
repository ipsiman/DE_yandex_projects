# Работа по ETL и автоматизации подготовки данных

## Задача 1

Адаптируем пайплайн для текущей задачи:
- Учтем в витрине mart.f_sales статусы shipped и refunded.
- Обновим пайплайн с учётом статусов и backward compatibility.

## Задача 1

На основе пайплайна из сквозной задачи наполним витрину mart.f_customer_retention данными по «возвращаемости клиентов» в разрезе недель.

Эта витрина должна отражать следующую информацию:
- Рассматриваемый период — weekly.
- Возвращаемость клиентов:
	- new — кол-во клиентов, которые оформили один заказ за рассматриваемый период;
	- returning — кол-во клиентов, которые оформили более одного заказа за рассматриваемый период;
	- refunded — кол-во клиентов, которые вернули заказ за рассматриваемый период.
- Доход (revenue) и refunded для каждой категории покупателей.

Схема витрины mart.f_customer_retention:
mart.f_customer_retention
1. new_customers_count — кол-во новых клиентов (тех, которые сделали только один 
заказ за рассматриваемый промежуток времени).
2. returning_customers_count — кол-во вернувшихся клиентов (тех,
которые сделали только несколько заказов за рассматриваемый промежуток времени).
3. refunded_customer_count — кол-во клиентов, оформивших возврат за 
рассматриваемый промежуток времени.
4. period_name — weekly.
5. period_id — идентификатор периода (номер недели или номер месяца).
6. item_id — идентификатор категории товара.
7. new_customers_revenue — доход с новых клиентов.
8. returning_customers_revenue — доход с вернувшихся клиентов.
9. customers_refunded — количество возвратов клиентов.

Благодаря витрине можно будет выяснить, какие категории товаров лучше всего удерживают клиентов.